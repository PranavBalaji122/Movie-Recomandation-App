import React from "react";
// import Form from "../components/Form";
import { useState } from "react";
import api from "../api";
import { useNavigate } from "react-router-dom";
import { ACCESS_TOKEN, REFRESH_TOKEN } from "../constants";
import './css/home.css'


function Login() {
   const route = 'token/'
   const [username, setUsername] = useState("");
   const [password, setPassword] = useState("");
   const [loading, setLoading] = useState(false);
   const navigate = useNavigate();
   const name = "Login" ;
   const method = 'login';
   const handleSubmit = async (e) => {
       setLoading(true);
       e.preventDefault();
       try {
           const res = await api.post(route, { username, password });
           if (method === "login") {
               localStorage.setItem(ACCESS_TOKEN, res.data.access);
               localStorage.setItem(REFRESH_TOKEN, res.data.refresh);
               navigate("/");
           }
       } catch (error) {
           console.log(error)
       } finally {
           setLoading(false);
       }
   };




   return(
       <div className="mainContainerLoginPage">
           <div className="backgroundContainer">
          
               <form onSubmit={handleSubmit} className="formContainerLogin">
                  
                       <h1>{name}</h1>
                       <input
                           className="formInput"
                           type="text"
                           value={username}
                           onChange={(e) => setUsername(e.target.value)}
                           placeholder="Username"
                       />
                       <input
                           className="formInput"
                           type="password"
                           value={password}
                           onChange={(e) => setPassword(e.target.value)}
                           placeholder="Password"
                       />
                       <button className="formButtonLogin" type="submit">
                           {loading ? "Loading..." : name}
                       </button>
                       <h6></h6>
               </form>
   </div>
       </div>
   );
}


export default Login;
